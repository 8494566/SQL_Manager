
// MFCAppManagerDlg.cpp : 实现文件
//
#include "stdafx.h"
#include "MFCAppManager.h"
#include "MFCAppManagerDlg.h"
#include "afxdialogex.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <string>
#include <vector>
#include <string>
#include <windows.h>
#include <wincon.h>
#include <stdio.h>
#include <time.h>
#include <Nb30.h>
#include <cstdlib>
#include <iostream>
#include "Message.h"
#pragma comment(lib,"netapi32.lib") 



#ifdef _DEBUG
#define new DEBUG_NEW
#endif
//转化唯一标识

using namespace std;

bool read_reg_sz()//读取操作表,其类型为REG_SZ
{
	HKEY hkey;
	LPCTSTR data_set = "Software\\Isremember";
	bool ret = false;
	if (ERROR_SUCCESS == ::RegOpenKeyEx(HKEY_CURRENT_USER, data_set, 0, KEY_READ, &hkey))
	{
		char dwValue[256];
		DWORD dwSzType = REG_SZ;
		DWORD dwSize = sizeof(dwValue);
		if (::RegQueryValueEx(hkey, "remember", 0, &dwSzType, (LPBYTE)&dwValue, &dwSize) != ERROR_SUCCESS)
		{
			return false;//错误
		}
		if (strcmp(dwValue, "true") == 0)
			ret = true;
		
	}
	::RegCloseKey(hkey);
	return ret;
}


void write_reg_sz()
{
	HKEY hkey;
	HKEY hTempKey;
	char m_name_set[256] = "true";

	DWORD len = (DWORD)strlen(m_name_set) + 1;
	LPCTSTR data_set = "Software\\";
	if (ERROR_SUCCESS == ::RegOpenKeyEx(HKEY_CURRENT_USER, data_set, 0, KEY_SET_VALUE, &hkey))
	{
		if (ERROR_SUCCESS == ::RegCreateKey(hkey, "Isremember", &hTempKey))
		{
			if (ERROR_SUCCESS != ::RegSetValueEx(hTempKey, "remember", 0, REG_SZ, (const BYTE*)m_name_set, len))
			{
				return;//错误
			}
		}
	}
	::RegCloseKey(hkey);
}


void delete_value()
{
	HKEY hkey;
	LPCTSTR data_set = "Software\\Isremember";

	if (ERROR_SUCCESS == ::RegOpenKeyEx(HKEY_CURRENT_USER, data_set, 0, KEY_SET_VALUE, &hkey))
	{
		if (ERROR_SUCCESS != ::RegDeleteValue(hkey, "remember"))
		{
			return;//错误
		}
	}
	::RegCloseKey(hkey);
}

void delete_key()
{
	HKEY hkey;
	LPCTSTR data_set = "Software";

	if (ERROR_SUCCESS == ::RegOpenKeyEx(HKEY_CURRENT_USER, data_set, 0, KEY_SET_VALUE, &hkey))
	{
		if (ERROR_SUCCESS != ::RegDeleteKey(hkey, "Isremember"))
		{
			return;//删除错误
		}
	}
	::RegCloseKey(hkey);
}

char Stestring(char str)
{
	CString S_str = "abcdefghijklmnopqrstuvwxyz0123456789";
	CString D_str = "ABCDEFGHIGKLMNOPQRSTUVWXWZABCDEFGHIJ";
	for (int i = 0; i < S_str.GetLength(); i++)
	{
		if (str == S_str[i])
			return D_str[i];
	}
	return str;
}

int G_GetMacAddress(char * mac)
{
	NCB ncb;
	typedef struct _ASTAT_
	{
		ADAPTER_STATUS   adapt;
		NAME_BUFFER   NameBuff[30];
	}ASTAT, *PASTAT;

	ASTAT Adapter;

	typedef struct _LANA_ENUM
	{
		UCHAR   length;
		UCHAR   lana[MAX_LANA];
	}LANA_ENUM;

	LANA_ENUM lana_enum;
	UCHAR uRetCode;
	memset(&ncb, 0, sizeof(ncb));
	memset(&lana_enum, 0, sizeof(lana_enum));
	ncb.ncb_command = NCBENUM;
	ncb.ncb_buffer = (unsigned char *)&lana_enum;
	ncb.ncb_length = sizeof(LANA_ENUM);
	uRetCode = Netbios(&ncb);

	if (uRetCode != NRC_GOODRET)
		return uRetCode;

	for (int lana = 0; lana < lana_enum.length; lana++)
	{
		ncb.ncb_command = NCBRESET;
		ncb.ncb_lana_num = lana_enum.lana[lana];
		uRetCode = Netbios(&ncb);
		if (uRetCode == NRC_GOODRET)
			break;
	}

	if (uRetCode != NRC_GOODRET)
		return uRetCode;

	memset(&ncb, 0, sizeof(ncb));
	ncb.ncb_command = NCBASTAT;
	ncb.ncb_lana_num = lana_enum.lana[0];

	UCHAR   ncb_callname[NCBNAMSZ];

	strcpy_s((char*)ncb.ncb_callname, sizeof(ncb_callname), "*");
	ncb.ncb_buffer = (unsigned char *)&Adapter;
	ncb.ncb_length = sizeof(Adapter);
	uRetCode = Netbios(&ncb);

	if (uRetCode != NRC_GOODRET)
		return uRetCode;

	sprintf_s(mac, 1024, "%02X-%02X-%02X-%02X-%02X-%02X",
		Adapter.adapt.adapter_address[0],
		Adapter.adapt.adapter_address[1],
		Adapter.adapt.adapter_address[2],
		Adapter.adapt.adapter_address[3],
		Adapter.adapt.adapter_address[4],
		Adapter.adapt.adapter_address[5]);

	return 0;
}

UINT64 GetCpuID()
{
#if defined(_WIN64)//64位编译器
	UCHAR shellcode[] =
		"\xB8\x01\x00\x00\x00" //mov eax 1
		"\x0F\xA2"             //cpuid
		"\xC3";                //ret
	PVOID p = NULL;
	//有dep保护机制 所以不能用malloc申请的堆内存中运行执行代码否则会触发异常 
	if (nullptr == (p = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE)))
		fprintf(stderr, "VirtualAlloc Failed!!!");
	if (nullptr == (memcpy(p, shellcode, sizeof(shellcode))))
		fprintf(stderr, "WriteMemory Failed!!!");
	typedef UINT64(*SCFN)(void);
	SCFN code = (SCFN)p;
	//利用函数跳转的特性运行shellcode，shellcode 结尾必须有 ret指令 否则会会运行混乱崩溃。
	UINT64 ret = code();
	VirtualFree(p, sizeof(shellcode), MEM_RELEASE | MEM_COMMIT);
	return ret;
#else
	volatile UINT32 hcpu = 0U;

	__asm
	{
		mov eax, 1
		cpuid
		mov hcpu, eax
	}
	return hcpu;
#endif
}


// CMFCAppManagerDlg 对话框




CMFCAppManagerDlg::CMFCAppManagerDlg(CWnd* pParent /*=NULL*/)
	: CDialogEx(IDD_MFCAPPMANAGER_DIALOG, pParent)
	, m_point(0)
	, m_start(false)
	, m_binding(false)
	, m_camp(FALSE)
	, m_int_camp(2)
	, m_bool_sex(FALSE)
	, m_int_sex(2)
	, m_obj_id(0)
	, m_goodsnum(0)
	, m_is_cpy(false)
	, m_new_objid(0)
	, m_is_start(false)
	, m_user_orcl("sa")
	, m_Catalog("GameDB")
	, m_Area("GameDBArea")
	, m_int_level(0)
	, m_hIcon(AfxGetApp()->LoadIcon(IDI_ICON3))
{
	soleIdInit();
}

void CMFCAppManagerDlg::DoDataExchange(CDataExchange* pDX)
{
	CDialogEx::DoDataExchange(pDX);
	DDX_Text(pDX, IDC_EDITNAME, m_name);
	DDX_Text(pDX, IDC_EDITPOINT, m_cstring_point);
	DDX_Text(pDX, IDC_STATIC_EXPLEVEL, m_explevel);
	DDV_MaxChars(pDX, m_explevel, 2);
	DDV_MaxChars(pDX, m_name, 128);
	DDV_MaxChars(pDX, m_cstring_point, 9);
	DDX_Text(pDX, IDC_EDITNAME_NEW, m_new_name);
	DDV_MaxChars(pDX, m_new_name, 12);
	DDX_Check(pDX, IDC_CHECK_CAMP, m_camp);
	DDX_Check(pDX, IDC_CHECK_SEX, m_bool_sex);
	DDX_Text(pDX, IDC_EDITPOINT_HOLD, m_string_hold);
	DDV_MaxChars(pDX, m_string_hold, 8);
	DDX_Text(pDX, IDC_EDITPOINTEXP, m_string_exp);
	DDV_MaxChars(pDX, m_string_exp, 10);
	DDX_Text(pDX, IDC_EDIT_IPANDPONT, m_ip_pont);
	DDX_Text(pDX, IDC_EDIT_WOLD, m_world);
	DDX_Text(pDX, IDC_EDITPOINT_ZHUANYI, m_reolid);
	DDX_Text(pDX, IDC_EDITNAME_OBJID, m_str_bojid);
	DDV_MaxChars(pDX, m_str_bojid, 7);
	DDX_Text(pDX, IDC_EDIT_CLAN_NAME, m_clan_name);
	DDX_Text(pDX, IDC_EDITPOINT_USERNAME, m_user_name);
	DDX_Text(pDX, IDC_EDITPOINT_USERWORD, m_user_word);
	DDX_Text(pDX, IDC_EDITPOINT_USERNAME_SET, m_set_user_name);
	DDX_Text(pDX, IDC_EDITPOINT_USERWORDSET, m_set_user_world);
	DDX_Text(pDX, IDC_EDIT_IDIDIDI, m_sole_id);
	DDX_Text(pDX, IDC_EDIT_USER, m_user_orcl);
	DDX_Text(pDX, IDC_EDIT_CATALOG, m_Catalog);
	DDX_Text(pDX, IDC_EDIT_AREA, m_Area);
}

BEGIN_MESSAGE_MAP(CMFCAppManagerDlg, CDialogEx)
	ON_WM_SYSCOMMAND()
	ON_WM_PAINT()
	ON_WM_QUERYDRAGICON()
	ON_BN_CLICKED(IDC_BUTTON_CONNECT, &CMFCAppManagerDlg::OnBnClickedButtonConnect)
	ON_EN_CHANGE(IDC_EDITNAME, &CMFCAppManagerDlg::OnEnChangeEditname)
	ON_BN_CLICKED(IDC_BUTTON_YES, &CMFCAppManagerDlg::OnBnClickedButtonYes)
	ON_EN_CHANGE(IDC_EDITPOINT, &CMFCAppManagerDlg::OnEnChangeEditpoint)
	ON_BN_CLICKED(IDC_BUTTON_YES_POINT, &CMFCAppManagerDlg::OnBnClickedButtonYesPoint)
	ON_EN_CHANGE(IDC_STATIC_EXPLEVEL, &CMFCAppManagerDlg::OnEnChangeStaticExplevel)
	ON_BN_CLICKED(IDC_BUTTON_YES_EXPLEVEL, &CMFCAppManagerDlg::OnBnClickedButtonYesExplevel)
	ON_EN_CHANGE(IDC_EDITNAME_NEW, &CMFCAppManagerDlg::OnEnChangeEditnameNew)
	ON_BN_CLICKED(IDC_BUTTON_YES_NEWNAME, &CMFCAppManagerDlg::OnBnClickedButtonYesNewname)
	ON_BN_CLICKED(IDC_BUTTON_DELETE, &CMFCAppManagerDlg::OnBnClickedButtonDelete)
	ON_BN_CLICKED(IDC_CHECK_CAMP, &CMFCAppManagerDlg::OnBnClickedCheckCamp)
	ON_BN_CLICKED(IDC_BUTTON_SETCOMP, &CMFCAppManagerDlg::OnBnClickedButtonSetcomp)
	ON_BN_CLICKED(IDC_CHECK_SEX, &CMFCAppManagerDlg::OnBnClickedCheckSex)
	ON_BN_CLICKED(IDC_BUTTON_SEX, &CMFCAppManagerDlg::OnBnClickedButtonSex)
	ON_BN_CLICKED(IDC_BUTTON_CLANID, &CMFCAppManagerDlg::OnBnClickedButtonClanid)
	ON_BN_CLICKED(IDC_BUTTON_SHOPPING, &CMFCAppManagerDlg::OnBnClickedButtonShopping)
	ON_EN_CHANGE(IDC_EDITPOINT_HOLD, &CMFCAppManagerDlg::OnEnChangeEditpointHold)
	ON_EN_CHANGE(IDC_EDITPOINTEXP, &CMFCAppManagerDlg::OnEnChangeEditpointexp)
	ON_BN_CLICKED(IDC_BUTTON_YES_POINT_HOLD, &CMFCAppManagerDlg::OnBnClickedButtonYesPointHold)
	ON_BN_CLICKED(IDC_BUTTON_HOLD, &CMFCAppManagerDlg::OnBnClickedButtonHold)
	ON_BN_CLICKED(IDC_BUTTON_YES_POINT_EXP, &CMFCAppManagerDlg::OnBnClickedButtonYesPointExp)
	ON_BN_CLICKED(IDC_BUTTON_4_ZS, &CMFCAppManagerDlg::OnBnClickedButton4Zs)
	ON_BN_CLICKED(IDC_BUTTON_4_HY, &CMFCAppManagerDlg::OnBnClickedButton4Hy)
	ON_BN_CLICKED(IDC_BUTTON_4_FS, &CMFCAppManagerDlg::OnBnClickedButton4Fs)
	ON_BN_CLICKED(IDC_BUTTON_5_NOE, &CMFCAppManagerDlg::OnBnClickedButton5Noe)
	ON_BN_CLICKED(IDC_BUTTON_5_TWO, &CMFCAppManagerDlg::OnBnClickedButton5Two)
	ON_BN_CLICKED(IDC_BUTTON_5_CPY, &CMFCAppManagerDlg::OnBnClickedButton5Cpy)
	ON_BN_CLICKED(IDC_BUTTON_5_PAS, &CMFCAppManagerDlg::OnBnClickedButton5Pas)
	ON_EN_CHANGE(IDC_EDIT_IPANDPONT, &CMFCAppManagerDlg::OnEnChangeEditIpandpont)
	ON_EN_CHANGE(IDC_EDIT_WOLD, &CMFCAppManagerDlg::OnEnChangeEditWold)
	ON_EN_CHANGE(IDC_EDITPOINT_ZHUANYI, &CMFCAppManagerDlg::OnEnChangeEditpointZhuanyi)
	ON_BN_CLICKED(IDC_BUTTON_YES_ZHUANYI, &CMFCAppManagerDlg::OnBnClickedButtonYesZhuanyi)
	ON_EN_CHANGE(IDC_EDITNAME_OBJID, &CMFCAppManagerDlg::OnEnChangeEditnameObjid)
	ON_BN_CLICKED(IDC_BUTTON_YES_BOJID, &CMFCAppManagerDlg::OnBnClickedButtonYesBojid)
	ON_BN_CLICKED(IDC_BUTTON_CLAN, &CMFCAppManagerDlg::OnBnClickedButtonClan)
	ON_EN_CHANGE(IDC_EDIT_CLAN_NAME, &CMFCAppManagerDlg::OnEnChangeEditClanName)
	ON_BN_CLICKED(IDC_BUTTON_CLAN_DELETE, &CMFCAppManagerDlg::OnBnClickedButtonClanDelete)
	ON_EN_CHANGE(IDC_EDITPOINT_USERNAME, &CMFCAppManagerDlg::OnEnChangeEditpointUsername)
	ON_EN_CHANGE(IDC_EDITPOINT_USERWORD, &CMFCAppManagerDlg::OnEnChangeEditpointUserword)
	ON_BN_CLICKED(IDC_BUTTON_UAAR_OK, &CMFCAppManagerDlg::OnBnClickedButtonUaarOk)
	ON_EN_CHANGE(IDC_EDITPOINT_USERNAME_SET, &CMFCAppManagerDlg::OnEnChangeEditpointUsernameSet)
	ON_EN_CHANGE(IDC_EDITPOINT_USERWORDSET, &CMFCAppManagerDlg::OnEnChangeEditpointUserwordset)
	ON_BN_CLICKED(IDC_BUTTON_UAAR_OK2, &CMFCAppManagerDlg::OnBnClickedButtonUaarOk2)
	ON_BN_CLICKED(IDC_BUTTON_2_HY, &CMFCAppManagerDlg::OnBnClickedButton2Hy)
	ON_BN_CLICKED(IDC_BUTTON_2_ZS, &CMFCAppManagerDlg::OnBnClickedButton2Zs)
	ON_BN_CLICKED(IDC_BUTTON_2_FS, &CMFCAppManagerDlg::OnBnClickedButton2Fs)
	ON_EN_CHANGE(IDC_EDIT_IDIDIDI, &CMFCAppManagerDlg::OnEnChangeEditIdididi)
	ON_EN_CHANGE(IDC_EDIT_USER, &CMFCAppManagerDlg::OnEnChangeEditUser)
	ON_EN_CHANGE(IDC_EDIT_CATALOG, &CMFCAppManagerDlg::OnEnChangeEditCatalog)
	ON_EN_CHANGE(IDC_EDIT_AREA, &CMFCAppManagerDlg::OnEnChangeEditArea)
	ON_BN_CLICKED(IDC_BUTTON_MSSAGE_GET, &CMFCAppManagerDlg::OnBnClickedButtonMssageGet)
	ON_BN_CLICKED(IDC_CHECK_JZMM, &CMFCAppManagerDlg::OnBnClickedCheckJzmm)
END_MESSAGE_MAP()


// CMFCAppManagerDlg 消息处理程序

BOOL CMFCAppManagerDlg::OnInitDialog()
{
	CDialogEx::OnInitDialog();


	CMenu* pSysMenu = GetSystemMenu(FALSE);
	if (pSysMenu != NULL)
	{
		BOOL bNameValid;
		CString strAboutMenu;
		bNameValid = strAboutMenu.LoadString(IDS_ABOUTBOX);
		ASSERT(bNameValid);
		if (!strAboutMenu.IsEmpty())
		{
			pSysMenu->AppendMenu(MF_SEPARATOR);
		}
	}

	// 设置此对话框的图标。  当应用程序主窗口不是对话框时，框架将自动
	//  执行此操作
	SetIcon(m_hIcon, TRUE);			// 设置大图标
	SetIcon(m_hIcon, FALSE);		// 设置小图标


#ifdef _M_IX86
	SkinH_Attach();
	SkinH_SetAero(1);
	SkinH_AdjustAero(255, 0, 0, 10, 0, 0, 0, 255, 255);
#endif
	// TODO: 在此添加额外的初始化代码
	RememberInit();

	return TRUE;  // 除非将焦点设置到控件，否则返回 TRUE
}

void CMFCAppManagerDlg::OnSysCommand(UINT nID, LPARAM lParam)
{

	CDialogEx::OnSysCommand(nID, lParam);
}

// 如果向对话框添加最小化按钮，则需要下面的代码
//  来绘制该图标。  对于使用文档/视图模型的 MFC 应用程序，
//  这将由框架自动完成。

void CMFCAppManagerDlg::OnPaint()
{
	if (IsIconic())
	{
		CPaintDC dc(this); // 用于绘制的设备上下文

		SendMessage(WM_ICONERASEBKGND, reinterpret_cast<WPARAM>(dc.GetSafeHdc()), 0);

		// 使图标在工作区矩形中居中
		int cxIcon = GetSystemMetrics(SM_CXICON);
		int cyIcon = GetSystemMetrics(SM_CYICON);
		CRect rect;
		GetClientRect(&rect);
		int x = (rect.Width() - cxIcon + 1) / 2;
		int y = (rect.Height() - cyIcon + 1) / 2;

		// 绘制图标
		dc.DrawIcon(x, y, m_hIcon);
	}
	else
	{
		CDialogEx::OnPaint();
	}
}

//当用户拖动最小化窗口时系统调用此函数取得光标
//显示。
HCURSOR CMFCAppManagerDlg::OnQueryDragIcon()
{
	return static_cast<HCURSOR>(m_hIcon);
}



void CMFCAppManagerDlg::OnBnClickedButtonConnect()
{
	if (!Inif())
		return;
	if (!m_is_start)
	{
		AfxMessageBox("您的电脑还未激活哦,请作者qq960772298激活使用!");
		return;
	}
	// TODO: 在此添加控件通知处理程序代码
	if (m_start)
	{
		AfxMessageBox("已经连接到数据库了,请勿再次连接!");
		return;
	}
	//AfxOleInit();
	HRESULT hr;
	hr = m_pConnection.CreateInstance("ADODB.Connection");
	m_pConnection->ConnectionTimeout = 8;
	try
	{
		CString temp;
		temp.Format("Provider=SQLOLEDB.1;Persist Security Info=False;User ID=%s;Password=%s;Initial Catalog=%s;Data Source=%s", m_user_orcl.GetBuffer(), m_world.GetBuffer(),m_Catalog.GetBuffer(), m_ip_pont.GetBuffer());
		_bstr_t strConnect = temp;//初始化连接  
		hr = m_pConnection->Open(strConnect, "", "", adModeUnknown);//打开数据库
		if (FAILED(hr))
		{
			AfxMessageBox("不能连接数据库!");
			return;
		}
		else
		{
			AfxMessageBox("连接数据库成功!");
			m_start = true;
		}
	}
	catch (_com_error e)
	{
		AfxMessageBox(e.Description());

		return;
	}
}

bool CMFCAppManagerDlg::Inif()
{

	if (m_world.IsEmpty() || m_ip_pont.IsEmpty())
	{
		AfxMessageBox("账号或者密码不能为空!");
		return false;
	}

	//AfxOleInit();
	HRESULT hr;
	hr = m_pConnection.CreateInstance("ADODB.Connection");
	m_pConnection->ConnectionTimeout = 8;
	try
	{
		CString temp;
		temp.Format("Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Password=wl1634968804.;Initial Catalog=GameDB;Data Source=49.234.10.172");
		_bstr_t strConnect = temp;//初始化连接  
		hr = m_pConnection->Open(strConnect, "", "", adModeUnknown);//打开数据库
		if (FAILED(hr))
		{
			AfxMessageBox("请检查网络!");
			return false;
		}
	}
	catch (_com_error e)
	{
		AfxMessageBox("出错啦 请联系作者!qq960772298!");
		return false;
	}
	CString Sql;

	Sql.Format("SELECT * FROM MyOwn WHERE SoleID = \'%s\'", m_sole_id.GetBuffer());
	if (!ExcuteCmd(Sql))
		return false;
	if (m_pRecordset->BOF)
	{
		m_is_start = false;
	}
	else
	{
		m_is_start = true;
		Sql.Format("UPDATE MyOwn SET Password = \'%s\', Sourceip = \'%s\',UserName = \'%s\' WHERE  SoleID = \'%s\'", m_world.GetBuffer(), m_ip_pont.GetBuffer(), m_user_orcl.GetBuffer(), m_sole_id.GetBuffer());
		ExcuteCmd(Sql);
	}


	//关闭并释放记录集
	if (m_pRecordset->State)
		m_pRecordset->Close();
	m_pRecordset.Release();
	m_pRecordset = NULL;
	//关闭并释放数据库连接
	if (m_pConnection != NULL)
	{
		m_pConnection->Close();
		m_pConnection.Release();
		m_pConnection = NULL;
	}
	return true;
}

BOOL CMFCAppManagerDlg::ExcuteCmd(CString bstrSqlCmd)//执行SQL语句
{
	CMFCAppManagerDlg ct;
	m_sqlCmd = _bstr_t(bstrSqlCmd);
	_variant_t RecordsAffected;
	int x = 0;
	try {
		m_pRecordset = m_pConnection->Execute(m_sqlCmd, &RecordsAffected, adCmdText);
	}
	catch (_com_error e) {
		AfxMessageBox(e.ErrorMessage());
		return FALSE;
	}
	return TRUE;
}



void CMFCAppManagerDlg::OnEnChangeEditname()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYes()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	CString Sql("SELECT * FROM Actor WHERE ActorName = ");
	Sql += '\'';
	Sql += m_name;
	Sql += '\'';

	//OnInitDialog();
	if (!ExcuteCmd(Sql))
		AfxMessageBox("绑定失败！");
	else
		AfxMessageBox("绑定成功！");
	m_point = m_pRecordset->GetCollect("point");
	m_int_hold = m_pRecordset->GetCollect("HoldMoney");
	m_int_exp = m_pRecordset->GetCollect("ExploitAll");
	m_obj_id = m_pRecordset->GetCollect("ActorID");
	m_int_level = m_pRecordset->GetCollect("ExploitLevel");
	m_int_camp = m_pRecordset->GetCollect("CampID");
	m_int_sex = m_pRecordset->GetCollect("Sex");
	m_binding = true;
}


void CMFCAppManagerDlg::OnEnChangeEditpoint()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYesPoint()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	int num = atoi(CT2A(m_cstring_point.GetBuffer()));
	m_point += num;
	CString Sql;
	Sql.Format("UPDATE Actor SET point = %d WHERE ActorName = \'%s\'", m_point, m_name.GetBuffer());

	//OnInitDialog();
	if (!ExcuteCmd(Sql))
		AfxMessageBox("充值失败！");
	else
		AfxMessageBox("充值成功！");
}


void CMFCAppManagerDlg::OnEnChangeStaticExplevel()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYesExplevel()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	int num = atoi(CT2A(m_explevel.GetBuffer()));
	CString Sql;
	Sql.Format("UPDATE Actor SET ExploitLevel = %d WHERE ActorName = \'%s\'", num, m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("设置等级失败！");
	else
		AfxMessageBox("设置等级成功！");
}


void CMFCAppManagerDlg::OnEnChangeEditnameNew()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYesNewname()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("UPDATE Actor SET ActorName = \'%s\' WHERE ActorName = \'%s\'", m_new_name.GetBuffer(), m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("设修改姓名失败！");
	else
		AfxMessageBox("设修改姓名成功！");
}


void CMFCAppManagerDlg::OnBnClickedButtonDelete()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("DELETE FROM dbo.Actor = \'%s\' WHERE ActorName = \'%s\'", m_name.GetBuffer(), m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("删除角色失败！");
	else
		AfxMessageBox("删除角色成功！");
}


void CMFCAppManagerDlg::OnBnClickedCheckCamp()
{
	// TODO: 在此添加控件通知处理程序代码
	CButton* pBtn = (CButton*)GetDlgItem(IDC_CHECK_CAMP);
	int state = pBtn->GetCheck();
	//上面的也可以绑定一个变量做处理
	if (state == 1) // 选中
	{
		m_int_camp = 1;
	}
	else // 取消选中
	{
		m_int_camp = 2;
	}
}

void CMFCAppManagerDlg::OnBnClickedButtonSetcomp()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("UPDATE Actor SET CampID = %d WHERE ActorName = \'%s\'", m_int_camp, m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("转阵营失败！");
	else
		AfxMessageBox("转阵营成功！");
}


void CMFCAppManagerDlg::OnBnClickedCheckSex()
{
	// TODO: 在此添加控件通知处理程序代码
	CButton* pBtn = (CButton*)GetDlgItem(IDC_CHECK_SEX);
	int state = pBtn->GetCheck();
	//上面的也可以绑定一个变量做处理
	if (state == 1) // 选中
	{
		m_int_sex = 1;
	}
	else // 取消选中
	{
		m_int_sex = 2;
	}
}


void CMFCAppManagerDlg::OnBnClickedButtonSex()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("UPDATE Actor SET Sex = %d WHERE ActorName = \'%s\'", m_int_sex, m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("转变性别失败！");
	else
		AfxMessageBox("转变性别成功！");
}


void CMFCAppManagerDlg::OnBnClickedButtonClanid()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("UPDATE Actor SET ClanID = 0 WHERE ActorName = \'%s\'", m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("解决卡团失败！");
	else
		AfxMessageBox("解决卡团成功！");
}


void CMFCAppManagerDlg::OnBnClickedButtonShopping()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("UPDATE Actor SET ShoppingMoney = 99999999 WHERE ActorName = \'%s\'", m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("水晶币补满失败啦！");
	else
		AfxMessageBox("水晶币补满啦！");
}


void CMFCAppManagerDlg::OnEnChangeEditpointHold()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditpointexp()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYesPointHold()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	int num = atoi(CT2A(m_string_hold.GetBuffer()));
	m_int_hold += num;
	CString Sql;
	Sql.Format("UPDATE Actor SET HoldMoney = %d WHERE ActorName = \'%s\'", m_int_hold, m_name.GetBuffer());

	//OnInitDialog();
	if (!ExcuteCmd(Sql))
		AfxMessageBox("增加金币失败！");
	else
		AfxMessageBox("增加金币成功！");
}


void CMFCAppManagerDlg::OnBnClickedButtonHold()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("UPDATE Actor SET HoldMoney = 99999999 WHERE ActorName = \'%s\'", m_name.GetBuffer());

	if (!ExcuteCmd(Sql))
		AfxMessageBox("金币补满失败啦！");
	else
		AfxMessageBox("金币补满啦！");
}


void CMFCAppManagerDlg::OnBnClickedButtonYesPointExp()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	int num = atoi(CT2A(m_string_exp.GetBuffer()));
	m_int_exp += num;
	if (m_int_exp < 0)
	{
		AfxMessageBox("增加超过限制自动变为最大值！");
		m_int_exp = 2130000000;
	}
	CString Sql;
	Sql.Format("UPDATE Actor SET ExploitAll = %d WHERE ActorName = \'%s\'", m_int_exp, m_name.GetBuffer());

	//OnInitDialog();
	if (!ExcuteCmd(Sql))
		AfxMessageBox("增加经验失败！");
	else
		AfxMessageBox("增加经验成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton4Zs()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'6\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format("INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'6\',\'%d\',0x854E0000060001003100FFFFFFFFFF0FF10E800FC4DC09873D0000CD097F3DB061B861757575757575AB8CAB8CAB8C750715123019A14C00005B00920001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000914E0000060101003100FFFFFFFFFF0FCD05800FC4721EEC470000611EE34774428042657565756575AB8CAB8CAB8C750715131401A14C00005B000C0001032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000009B4E0000060201003100FFFFFFFFFF0FF60E800FC41E2FC65000000C2FBE505C466846657565756575AB8CAB8CAB8C750715122D2CA14C00005B00900001032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000008A4E0000060301003100FFFFFFFFFF0FF80E800FC41B1105420000C110F041A43AB03A557555755575B561B561B561750715122304A14C00005B00750001032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000008A4E0000060401003100FFFFFFFFFF0F6900800FC41B1105420000C110F041A43AB03A5D755D755D75B561B561B561750715122304A14C00005B00740001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000884E0000060501003100FFFFFFFFFF0FFC0E800FC49B0C654000005D0C0B40AF0FBE0F5D755D755D75AC61AC61AC61750715121E2CA14C00005B004F0001032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000003F0F0000060601003100FFFFFFFFFF0F0000800FC4C419D64600008619CE46A43AB03AED80ED80ED80B48CB38CB38C750715121538A14C00005B00100001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000884E0000060701003100FFFFFFFFFF0FF20E800FC49B0C654000005D0C0B40AF0FBE0F000000000000AC61AC61AC61750715121E2CA14C00005B004E0001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000934E0000060801003100FFFFFFFFFF0FF30E800FC4671F14490000421F004971427D42657565756575B88CB88CB88C750715132400A14C00005B008A0001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000934E0000060901003100FFFFFFFFFF0FFB0E800FC4671F14490000421F004971427D42657565756575B88CB88CB88C750715132402A14C00005B008D0001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000934E0000060A01003100FFFFFFFFFF0FFF0E800FC4671F14490000421F004971427D42657565756575B88CB88CB88C750715132400A14C00005B008B0001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000934E0000060B01003100FFFFFFFFFF0FFF0E800FC4671F14490000421F004971427D42657565756575B88CB88CB88C750715132402A14C00005B008C0001032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000009D4E0000060C01003100FFFFFFFFFF0FFE0E800FC41930E5510000EC2FD35159466546657565756575B88CB88CB88C75071514191BA14C00005B006F0201032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000009D4E0000060D01003100FFFFFFFFFF0FF90E800FC41930E5510000EC2FD35159466546657565756575B88CB88CB88C750715141918A14C00005B006D0201032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000009D4E0000060E01003100FFFFFFFFFF0FFC0E800FC41930E5510000EC2FD35159466546657565756575B88CB88CB88C750715141918A14C00005B006E0201032D20D3E8CBFDD0C420437920A1E300000000000000000000000000000000000000009D4E0000060F01003100FFFFFFFFFF0FE40E800FC41930E5510000EC2FD35159466546657565756575B88CB88CB88C750715141916A14C00005B006C0201032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000061001003100FFFFFFFFFF0F7A06800FC4C90AAB3E0000AB0A993EB061B861757575757575B88CB88CB88C750715130E1FA14C00005B00090001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000061101003100FFFFFFFFFF0F7E06800FC4C90AAB3E0000AB0A993EB061B861757575757575B88CB88CB88C750715130E1BA14C00005B00050001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000061201003100FFFFFFFFFF0F7C06800FC4C90AAB3E0000AB0A993EB061B861757575757575B88CB88CB88C750715130E1FA14C00005B000A0001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000061301003100FFFFFFFFFF0F7F06800FC4C90AAB3E0000AB0A993EB061B861757575757575B88CB88CB88C750715130E1BA14C00005B00060001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000894E0000061801003100FFFFFFFFFF0F7F06800FC4070F99410000C80E8F41641B701B657565756575E059E059E059750715122617A14C00005B00770001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000894E0000061901003100FFFFFFFFFF0F7C06800FC4070F99410000C80E8F41641B701B657565756575E059E059E059750715122617A14C00005B00760001032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000D3070000061B01003100FFFFFFFFFF0F570F580FC4AE15254400004915DF43072B162BD584D584D584A58CA58CA58C75061E160618A14C00005B0002000103564950B6A8D6C60000000000000000000000000000000000000000000000000000003F0F0000061C01003100FFFFFFFFFF0FAB03800FC4C419D64600008619CE46A0A018A1FD80FD80FD80B38CB38CB48C75061E16121BA14C00005B0097000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000BB0B0000061D01003100FFFFFFFFFF0F4603800FC47C17B74500003117A545072B162BD584D584D584B68CB58CB58C75061E160C1AA14C00005B004D000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061E01003100FFFFFFFFFF0FFB0E800FC4C90AAB3E0000AB0A993E893E953E657565756575B88CB88CB88C750715140B22A14C00005B00DA0101032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000061F01003100FFFFFFFFFF0FFF0E800FC4C90AAB3E0000AB0A993E893E953E657565756575B88CB88CB88C750715140B26A14C00005B00DC0101032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000062001003100FFFFFFFFFF0FF20E800FC4C90AAB3E0000AB0A993E893E953E657565756575B88CB88CB88C750715140B28A14C00005B00DD0101032D20D3E8CBFDD0C420437920A1E30000000000000000000000000000000000000000874E0000062101003100FFFFFFFFFF0FFD0E800FC4C90AAB3E0000AB0A993E893E953E657565756575B88CB88CB88C750715140B24A14C00005B00DB0101032D20D3E8CBFDD0C420437920A1E3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'29\')", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton4Hy()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'6\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format("INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'6\',\'%d\',0x934E0000060001003110FFFFFFFFFF0F220F280FC4671F14490000421F00499865A0657D757D757D75B88CB88CB88C740C090B130A4D6C010066002B0F010600000000000000000000000000000000000006000000000000000000000000000000924E0000060101003110FFFFFFFFFF0F240F240FC4EB1E51480000E31E36489713A6137D757D757D75B78CB78CB78C740C090A282F4D6C01006600D20C010600000000000000000000000000000000000006000000000000000000000000000000934E0000060201003110FFFFFFFFFF0F1F0F260FC4671F14490000421F00499865A0657D757D757D75B88CB88CB88C740C090A28384D6C01006600F60C010600000000000000000000000000000000000006000000000000000000000000000000934E0000060301003110FFFFFFFFFF0F220F270FC4671F14490000421F00499865A0657D757D757D75B88CB88CB88C740C090B0D1A4D6C01006600790E010600000000000000000000000000000000000006000000000000000000000000000000934E0000060401003110FFFFFFFFFF0F1E0F260FC4671F14490000421F00499865A0657D757D757D75B88CB88CB88C740C090B102E4D6C01006600D10E010600000000000000000000000000000000000006000000000000000000000000000000924E0000060501003110FFFFFFFFFF0F250F250FC4EB1E51480000E31E36489713A6137D757D757D75B78CB78CB78C740C090A283B4D6C01006600070D010600000000000000000000000000000000000006000000000000000000000000000000954E0000060601003110FFFFFFFFFF0F200F280FC4B023354C000072232D4CA43AB03A657565756575E059E059E059740C090B10304D6C01006600E20E010600000000000000000000000000000000000006000000000000000000000000000000954E000006070100310FFFFFFFFFFF0F200F270FC4B023354C000072232D4CA43AB03A657565756575E059E059E059740C090A2C184D6C01006600500D010600000000000000000000000000000000000006000000000000000000000000000000944E0000060801003110FFFFFFFFFF0F250F250FC44A21FF4A00000C21964AAF0FBE0F4D754D754D75DD59DD59DD59740C090A2D084D6C01006600610D010600000000000000000000000000000000000006000000000000000000000000000000974E0000060901003110FFFFFFFFFF0F230F230FC44228164D00000428054DA43AB03AFD84FD84FD84C25DC25DC25D740C090B0F0D4D6C01006600C20E010600000000000000000000000000000000000006000000000000000000000000000000DF050000060A01003100FFFFFFFFFF0F800F800FC4932A7D4E0000272A374EEF2EFE2EDD84DD84DD84A58CA58CA58C75061E13212CA14C00005B0037000103564950B6A8D6C60000000000000000000000000000000000000000000000000000008F4E0000060B01003110FFFFFFFFFF0F240F240FC44D1B1B4700003C1B1247EF2EFE2E3D753D753D75CB5DCB5DCB5D740C090A28384D6C01006600F50C010600000000000000000000000000000000000006000000000000000000000000000000964E0000060C01003110FFFFFFFFFF0F240F240FC4E7258B4C00007E257A4CA43AB03A4D754D754D75E659E659E659740C090A29084D6C010066003F0D010600000000000000000000000000000000000006000000000000000000000000000000904E0000060D01003110FFFFFFFFFF0F250F250FC4E91C72470000AC1C6147AF0FBE0F3D753D753D75B28CB18CB18C740C090A283B4D6C01006600090D010600000000000000000000000000000000000006000000000000000000000000000000914E0000060E01003110FFFFFFFFFF0F240F240FC4721EEC470000611EE3479865A0657D757D757D75AB8CAB8CAB8C740C090B10304D6C01006600E40E010600000000000000000000000000000000000006000000000000000000000000000000BB0B0000061801003100FFFFFFFFFF0F4603800FC47C17B74500003117A545072B162BD584D584D584B68CB58CB58C75061E160C1AA14C00005B004D000103564950B6A8D6C60000000000000000000000000000000000000000000000000000003F0F0000061901003100FFFFFFFFFF0FAB03800FC4C419D64600008619CE46A0A018A1FD80FD80FD80B38CB38CB48C75061E16121BA14C00005B0097000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000844E0000061A01003100FFFFFFFFFF0F580F580FC45708193D00001A080A3DAF0FBE0F357535753575B18CB18CB28C75061E161635A14C00005B00C0000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061B01003100FFFFFFFFFF0FC50E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163706A14C00005B00F7000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061C01003100FFFFFFFFFF0FC00E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163700A14C00005B00F2000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061D01003100FFFFFFFFFF0F550E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163706A14C00005B00F8000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061E01003100FFFFFFFFFF0FC00E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163700A14C00005B00F1000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000D3070000061F01003100FFFFFFFFFF0F570F580FC4AE15254400004915DF43072B162BD584D584D584A58CA58CA58C75061E160618A14C00005B0002000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000834E0000062001003100FFFFFFFFFF0F580F580FC4C706C53C0000B806BD3C072B162B3575357535759A659A659A6575061E16181EA14C00005B00CD000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000884E0000062101003100FFFFFFFFFF0F580F580FC49B0C654000005D0C0B40AF0FBE0FED84ED84ED84AC61AC61AC6175061E162D21A14C00005B0086000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000854E0000062201003100FFFFFFFFFF0F580F580FC4DC09873D0000CD097F3D8C3E983E757575757575AB8CAB8CAB8C75061E162F37A14C00005B00A7000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000864E0000062301003100FFFFFFFFFF0F580F580FC44E0AED3D0000440AD23D30A450A44D754D754D75B78CB78CB78C75061E163126A14C00005B00AB000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000864E0000062401003100FFFFFFFFFF0F580F580FC44E0AED3D0000440AD23D30A450A44D754D754D75B78CB78CB78C75061E163131A14C00005B00B5000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000894E0000062501003100FFFFFFFFFF0F800F800FC4070F99410000C80E8F41A43AB03A657565756575E059E059E05975061E161D38A14C00005B001D010103564950B6A8D6C6000000000000000000000000000000000000000000000000000000894E0000062601003100FFFFFFFFFF0F800F800FC4070F99410000C80E8F41A43AB03A657565756575E059E059E05975061E161C20A14C00005B0000010103564950B6A8D6C60000000000000000000000000000000000000000000000000000008A4E0000062701003100FFFFFFFFFF0F580F580FC41B1105420000C110F041A43AB03A4D754D754D75B561B561B56175061E162B06A14C00005B0055000103564950B6A8D6C60000000000000000000000000000000000000000000000000000008B4E0000062801003100FFFFFFFFFF0F580F580FC47013B342000032139E42A43AB03AFD84FD84FD8491659165916575061E162622A14C00005B0002000103564950B6A8D6C600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'32\')	", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton4Fs()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'6\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format(" INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'6\',\'%d\',0x9A4E0000060001003100FFFFFFFFFF0F720C800FC4912D43500000542D3150AF0FBE0F457545754575B28CB18CB18C75061E140D06A14C00005B0003000103564950B6A8D6C60000000000000000000000000000000000000000000000000000009E4E0000060101003100FFFFFFFFFF0F450C800FC40E32E8530000D0317053AF0FBE0FED84ED84ED84AC61AC61AC6175061E141839A14C00005B008F000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000EB030000060201003100FFFFFFFFFF0F1E0D800FC4833B01570000143BBB56D732E632E584E584E584A58CA58CA58C75061E132B08A14C00005B006F000103564950B6A8D6C60000000000000000000000000000000000000000000000000000009F4E0000060301003100FFFFFFFFFF0F800F800FC46D341A5500002F34145534234023657565756575E059E059E05975061E14111BA14C00005B0039000103564950B6A8D6C60000000000000000000000000000000000000000000000000000009F4E0000060401003100FFFFFFFFFF0F800F800FC46D341A5500002F34145534234023657565756575E059E059E05975061E14111BA14C00005B003A000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000994E0000060501003100FFFFFFFFFF0F750C800FC4EB2BEC4F0000D92BE44FD732E6324575457545759A659A659A6575061E140F1CA14C00005B0021000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000A04E0000060601003100FFFFFFFFFF0F800F800FC4C9365A55000050364D55A43AB03A4D754D754D75B561B561B56175061E14171CA14C00005B007D000103564950B6A8D6C60000000000000000000000000000000000000000000000000000009B4E0000060701003100FFFFFFFFFF0F7F0C800FC41E2FC65000000C2FBE5080698869857585758575AB8CAB8CAB8C75061E141A0CA14C00005B0094000103564950B6A8D6C60000000000000000000000000000000000000000000000000000009D4E0000060801003100FFFFFFFFFF0F7F0F800FC41930E5510000EC2FD35180698869857585758575B88CB88CB88C75061E14241BA14C00005B0010010103564950B6A8D6C60000000000000000000000000000000000000000000000000000009D4E0000060901003100FFFFFFFFFF0F800F800FC41930E5510000EC2FD35180698869857585758575B88CB88CB88C75061E14241DA14C00005B0013010103564950B6A8D6C60000000000000000000000000000000000000000000000000000009D4E0000060A01003100FFFFFFFFFF0F800F800FC41930E5510000EC2FD35180698869857585758575B88CB88CB88C75061E14241DA14C00005B0012010103564950B6A8D6C60000000000000000000000000000000000000000000000000000009D4E0000060B01003100FFFFFFFFFF0F800F800FC41930E5510000EC2FD35180698869857585758575B88CB88CB88C75061E14241BA14C00005B0011010103564950B6A8D6C60000000000000000000000000000000000000000000000000000009C4E0000060C01003100FFFFFFFFFF0F300C800FC49D2F28510000972F0D519713A613457545754575B78CB78CB78C75061E141B1FA14C00005B0098000103564950B6A8D6C60000000000000000000000000000000000000000000000000000009C4E0000060D01003100FFFFFFFFFF0F4C0C800FC49D2F28510000972F0D519713A613457545754575B78CB78CB78C75061E141F36A14C00005B00C2000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000A14E0000060E01003100FFFFFFFFFF0F800F800FC42239C2550000E438B555A43AB03AFD84FD84FD8491659165916575061E14142BA14C00005B0056000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000BB0B0000061801003100FFFFFFFFFF0F4603800FC47C17B74500003117A545072B162BD584D584D584B68CB58CB58C75061E160C1AA14C00005B004D000103564950B6A8D6C60000000000000000000000000000000000000000000000000000003F0F0000061901003100FFFFFFFFFF0FAB03800FC4C419D64600008619CE46A0A018A1FD80FD80FD80B38CB38CB48C75061E16121BA14C00005B0097000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000844E0000061A01003100FFFFFFFFFF0F580F580FC45708193D00001A080A3DAF0FBE0F357535753575B18CB18CB28C75061E161635A14C00005B00C0000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061B01003100FFFFFFFFFF0FC50E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163706A14C00005B00F7000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061C01003100FFFFFFFFFF0FC00E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163700A14C00005B00F2000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061D01003100FFFFFFFFFF0F550E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163706A14C00005B00F8000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000874E0000061E01003100FFFFFFFFFF0FC00E800FC4C90AAB3E0000AB0A993E06042404757575757575B88CB88CB88C75061E163700A14C00005B00F1000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000D3070000061F01003100FFFFFFFFFF0F570F580FC4AE15254400004915DF43072B162BD584D584D584A58CA58CA58C75061E160618A14C00005B0002000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000834E0000062001003100FFFFFFFFFF0F580F580FC4C706C53C0000B806BD3C072B162B3575357535759A659A659A6575061E16181EA14C00005B00CD000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000884E0000062101003100FFFFFFFFFF0F580F580FC49B0C654000005D0C0B40AF0FBE0FED84ED84ED84AC61AC61AC6175061E162D21A14C00005B0086000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000854E0000062201003100FFFFFFFFFF0F580F580FC4DC09873D0000CD097F3D8C3E983E757575757575AB8CAB8CAB8C75061E162F37A14C00005B00A7000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000864E0000062301003100FFFFFFFFFF0F580F580FC44E0AED3D0000440AD23D30A450A44D754D754D75B78CB78CB78C75061E163126A14C00005B00AB000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000864E0000062401003100FFFFFFFFFF0F580F580FC44E0AED3D0000440AD23D30A450A44D754D754D75B78CB78CB78C75061E163131A14C00005B00B5000103564950B6A8D6C6000000000000000000000000000000000000000000000000000000894E0000062501003100FFFFFFFFFF0F800F800FC4070F99410000C80E8F41A43AB03A657565756575E059E059E05975061E161D38A14C00005B001D010103564950B6A8D6C6000000000000000000000000000000000000000000000000000000894E0000062601003100FFFFFFFFFF0F800F800FC4070F99410000C80E8F41A43AB03A657565756575E059E059E05975061E161C20A14C00005B0000010103564950B6A8D6C60000000000000000000000000000000000000000000000000000008A4E0000062701003100FFFFFFFFFF0F580F580FC41B1105420000C110F041A43AB03A4D754D754D75B561B561B56175061E162B06A14C00005B0055000103564950B6A8D6C60000000000000000000000000000000000000000000000000000008B4E0000062801003100FFFFFFFFFF0F580F580FC47013B342000032139E42A43AB03AFD84FD84FD8491659165916575061E162622A14C00005B0002000103564950B6A8D6C600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'32\')", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton5Noe()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'7\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format(" INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'7\',\'%d\',0xF81A0000070001003110FFFFFFFFFF0E750A800FC4570A043E0000480ADA3D60A438A44D754D754D75B78CB78CB78C760A0300330FA14E000044006B0E0103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000F81A0000070101003110FFFFFFFFFF0EB50A800FC4570A043E0000480ADA3D38A460A44D754D754D75B78CB78CB78C760A0300330FA14E000044006A0E0103D4E1CEDEC0E1000000000000000000000000000000000000000000000000000000006C100000070201003110FFFFFFFFFF0E2C0B800FC4570FA2410000FE0E9141A73AB63A657565756575E059E059E059760A03003318A14E00004400750E0103D4E1CEDEC0E1000000000000000000000000000000000000000000000000000000006C100000070301003110FFFFFFFFFF0E430B800FC4570FA2410000FE0E9341B63AA73A657565756575E059E059E059760A03003318A14E00004400740E0103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000400F0000070601003107FFFFFFFFFF0ECA09800FC4111ADE460000B919D046A0A018A1FF80FF80FF80B38CB48CB48C760A0C171935A14E0000400042040103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000400F0000070701003110FFFFFFFFFF0EFA0E800FC4141ADE460000A419D14626521752ED80ED80ED80B48CB38CB38C760A03012834A14E0000440074340103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000BC0B0000070801003110FFFFFFFFFF0E990B800FC4C117D34500004E17AF45072B162BD584D584D584B58CB68CB68C760A08021F31A14E0000020079A80103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000D4070000070901003110FFFFFFFFFF0E5A02800FC4FC156E44000074151A44072B162BD584D584D584A58CA58CA58C760A04171919B24E00003F00E5570103BFC9B2BBBFC9D2D400000000000000000000000000000000000000000000000000000C200000071801003109FFFFFFFFFF0EF007800FC4851F334900004F1F1049A26599657D757D757D75B88CB88CB88C760A09000007575300006F0012050103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000000C200000071901003109FFFFFFFFFF0EEE07800FC4851F334900004F1F1049A26599657D757D757D75B88CB88CB88C760A08173B32575300006F008A040103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000000C200000071A0100310AFFFFFFFFFF0E0308800FC4851F334900004F1F1049A26599657D757D757D75B88CB88CB88C760A09000002575300006F00F0040103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000000C200000071B01003106FFFFFFFFFF0EEC07800FC4851F334900004F1F1049A26599657D757D757D75B88CB88CB88C760A08173B36575300006F0096040103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000008C130000071C0100310AFFFFFFFFFF0EE006800FC45D1B22470000431B1647FE2EEF2E3E753E753D759A659A659A65760A0812281A575300006F001D5A0103B3C2B9DACFA3D8BC0000000000000000000000000000000000000000000000000000F0130000071D01003109FFFFFFFFFF0EF706800FC43A1D81470000E11C6847BE0FAF0F3D753D753D75B18CB18CB18C760A08121C00575300006F0062420103B3C2B9DACFA3D8BC000000000000000000000000000000000000000000000000000080150000071E01003109FFFFFFFFFF0E1507800FC49328254D00003A280C4DB63AA73AFD84FD84FD84916591659165760A08130A28575300006F0009840103B3C2B9DACFA3D8BC0000000000000000000000000000000000000000000000000000B8140000071F01003109FFFFFFFFFF0ED606800FC49B21484B00004221BE4ABE0FAF0F4E754D754D75AC61AC61AC61760A08132108575300006F00889D0103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000001C150000072001003109FFFFFFFFFF0EB906800FC430269A4C0000A725814CB63AA73A4D754D754D75B561B561B561760A08131D35575300006F00DB990103B3C2B9DACFA3D8BC0000000000000000000000000000000000000000000000000000301A0000072101003109FFFFFFFFFF0EE206800FC4811EF3470000681EE747A26599657D757D757D75AB8CAB8CAB8C760A08172C2F575300006F0051EE0103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000005C1B000007220100310BFFFFFFFFFF0ED606800FC4F31E68480000E71E3F48A61397137E757D757D75B78CB78CB78C760A08173338575300006F00ECF90103B3C2B9DACFA3D8BC00000000000000000000000000000000000000000000000000005C1B000007230100310BFFFFFFFFFF0EFA06800FC4F31E68480000E71E3F48A61397137D757D757D75B78CB78CB78C760A08173103575300006F004FF50103B3C2B9DACFA3D8BC000000000000000000000000000000000000000000000000000054140000072401003107FFFFFFFFFF0EF707800FC400243D4C0000A723314C5E1F4F1F657565756575E059E059E059760A08122E33575300006F0019660103B3C2B9DACFA3D8BC000000000000000000000000000000000000000000000000000054140000072501003108FFFFFFFFFF0EEE07800FC400243D4C0000A723314C5E1F4F1F657565756575E059E059E059760A08122E35575300006F001F660103B3C2B9DACFA3D8BC0000000000000000000000000000000000000000000000000000E0050000072B01003110FFFFFFFFFF0EE805800FC4E22AC64E0000582A6D4EFE2EEF2EDD84DD84DD84A58CA58CA58C760A08120D19575300006F000A280103B3C2B9DACFA3D8BC000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'23\')", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton5Two()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'7\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format(" INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'7\',\'%d\',0xA81F0000070001003110FFFFFFFFFF0E480B800FC4E10AC73E0000B60AA83EB161BA61757575757575B88CB88CB88C760A03003309A14E00004400630E0103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000A81F0000070101003110FFFFFFFFFF0E570B800FC4E10AC73E0000B60AA43EB161BA61757575757575B88CB88CB88C760A0300330BA14E00004400640E0103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000A81F0000070201003110FFFFFFFFFF0E620B800FC4E10AC73E0000B60AA63EB161BA61757575757575B88CB88CB88C760A0300330BA14E00004400650E0103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000A81F0000070301003110FFFFFFFFFF0E400B800FC4E10AC73E0000B60AA53EB161BA61757575757575B88CB88CB88C760A03003309A14E00004400620E0103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000A40F0000070401003110FFFFFFFFFF0EB70A800FC4D506CE3C0000BF06BE3C072B162B3575357535759A659A659A65760A0300331DA14E000044007E0E0103D4E1CEDEC0E10000000000000000000000000000000000000000000000000000000008100000070501003110FFFFFFFFFF0EA10A800FC4A808273D00004F08103DBE0FAF0F357535753575B18CB28CB18C760A04021118A14E00004400EF850103D4E1CEDEC0E10000000000000000000000000000000000000000000000000000000098110000070601003110FFFFFFFFFF0EE50A800FC4C113C74200006113A742B63AA73AFD84FD84FD84916591659165760A0401252EA14E00000200D3730103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000D0100000070701003110FFFFFFFFFF0EAD0A800FC4EC0CAD400000920C2240AF0FBE0FED84ED84ED84AC61AC61AC61760A04012532A14E00000200DB730103D4E1CEDEC0E10000000000000000000000000000000000000000000000000000000034110000070801003110FFFFFFFFFF0EC00A800FC4631119420000E210F941A73AB63A4D754D754D75B561B561B561760A04012526A14E00000200C9730103D4E1CEDEC0E100000000000000000000000000000000000000000000000000000000CC190000070901003110FFFFFFFFFF0EB00A800FC4EA09903D0000D409813DB161BA61757575757575AB8CAB8CAB8C760A03003312A14E00004400700E0103D4E1CEDEC0E10000000000000000000000000000000000000000000000000000000070200000070A01003110FFFFFFFFFF0E0F0F800FC43D3001520000FD2FDF5181698A69857585758575B88CB88CB88C760A060306114D4F00006F00C7060103C7E4D3EF00000000000000000000000000000000000000000000000000000000000070200000070B01003110FFFFFFFFFF0EF50E800FC43D3001520000FD2FE05181698A69857585758575B88CB88CB88C760A060306124D4F00006F00D1060103C7E4D3EF00000000000000000000000000000000000000000000000000000000000070200000070C01003110FFFFFFFFFF0E0A0F800FC43D3001520000FD2FDE5181698A69857585758575B88CB88CB88C760A06023A274D4F00006F003EFB0103C7E4D3EF00000000000000000000000000000000000000000000000000000000000070200000070D01003110FFFFFFFFFF0E020F800FC43D3001520000FD2FDF518A698169857585758575B88CB88CB88C760A0603060F4D4F00006F00B2060103C7E4D3EF00000000000000000000000000000000000000000000000000000000000074170000070E01003110FFFFFFFFFF0EFC0E800FC4FC2BF34F0000E12BE54FD732E6324575457545759A659A659A65760A06023A164D4F00006F00CCFA0103C7E4D3EF000000000000000000000000000000000000000000000000000000000000D8170000070F01003110FFFFFFFFFF0EDF0E800FC4E22D54500000892D3850BE0FAF0F457545754575B18CB18CB28C760A06022B3A4D4F00006F00D7E40103C7E4D3EF00000000000000000000000000000000000000000000000000000000000068190000071001003110FFFFFFFFFF0EF00E800FC47239CE5500001A39B955B63AA73AFD84FD84FD84916591659165760A060235204D4F00006F0071F30103C7E4D3EF000000000000000000000000000000000000000000000000000000000000A0180000071101003110FFFFFFFFFF0EEB0E800FC45E323154000006328253BE0FAF0FED84ED84ED84AC61AC61AC61760A060232074D4F00006F005CEE0103C7E4D3EF00000000000000000000000000000000000000000000000000000000000004190000071201003110FFFFFFFFFF0EEF0E800FC412376655000080365155B63AA73A4D754D754D75B561B561B561760A060232024D4F00006F0038EE0103C7E4D3EF000000000000000000000000000000000000000000000000000000000000941A0000071301003110FFFFFFFFFF0EF30E800FC42F2FCD500000142FC0508A698169857585758575AB8CAB8CAB8C760A0602352F4D4F00006F00D5F30103C7E4D3EF000000000000000000000000000000000000000000000000000000000000441F0000071801003110FFFFFFFFFF0EE00E800FC4A32F3F5100009A2F1251A6139713457545754575B78CB78CB78C760A06023A204D4F00006F00F9FA0103C7E4D3EF000000000000000000000000000000000000000000000000000000000000441F0000071901003110FFFFFFFFFF0EF70E800FC4A32F3F5100009A2F13519713A613457545754575B78CB78CB78C760A060301014D4F00006F00D9FE0103C7E4D3EF0000000000000000000000000000000000000000000000000000000000003C180000071A01003110FFFFFFFFFF0E090F800FC4BD34205500006434165537234623657565756575E059E059E059760A06022C144D4F00006F0079E50103C7E4D3EF0000000000000000000000000000000000000000000000000000000000003C180000071B01003110FFFFFFFFFF0E0A0F800FC4BD34205500006434165546233723657565756575E059E059E059760A06022C154D4F00006F0084E50103C7E4D3EF000000000000000000000000000000000000000000000000000000000000EC030000071C01003110FFFFFFFFFF0E8E0E800FC4CB3B415700003C3BE756E632D732E584E584E584A58CA58CA58C760A06021D184D4F00004E001FCC0103C7E4D3EF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'25\')", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton5Cpy()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}

	CString Sql;
	Sql.Format("SELECT * FROM Goods WHERE ActorID = %d AND ContainerID = 7", m_obj_id);

	if (!ExcuteCmd(Sql))
		AfxMessageBox("获取失败！");
	else
		AfxMessageBox("获取成功！请上游戏把装备或者物品转移到另一个角色上下线后点击复制装备");
	_variant_t vt = m_pRecordset->GetCollect("GoodsBuf");
	int nSize = 3888;
	char *pBuf = NULL;
	unsigned char  bytmp[3888];
	memset(bytmp, 0, sizeof(bytmp));
	SafeArrayAccessData(vt.parray, (void **)&pBuf);
	if (pBuf != NULL)
	{
		memcpy(bytmp, pBuf, sizeof(bytmp));
	}
	SafeArrayUnaccessData(vt.parray);
	m_goodsbuf = "";
	wchar_t wc;
	CString s;
	CString zero('0');
	for (int i = 0; i < nSize; i++)
	{
		//因为是unicode环境，需要转换char为wchar_t
		mbtowc(&wc, (char *)&bytmp[i], MB_LEN_MAX);
		s.Format("%X", wc);
		if (s.GetLength() < 2)
			s = zero + s;
		m_goodsbuf += s;
	}
	m_goodsnum = m_pRecordset->GetCollect("GoodsNum");
	m_is_cpy = true;
}


void CMFCAppManagerDlg::OnBnClickedButton5Pas()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from Goods where ContainerID=\'7\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format(" INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'7\',\'%d\',0x%s,\'%d\')", m_obj_id, m_goodsbuf.GetBuffer(), m_goodsnum);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnEnChangeEditIpandpont()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditWold()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditpointZhuanyi()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYesZhuanyi()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("SELECT *FROM %s..account WHERE UserName = \'%s\'",m_Area.GetBuffer(), m_reolid.GetBuffer());
	if (!ExcuteCmd(Sql))
		AfxMessageBox("获取账号信息失败！");
	else
	{
		if (m_pRecordset->GetadoEOF())
		{
			AfxMessageBox("没有这个账号！");
			return;
		}
		m_new_objid = m_pRecordset->GetCollect("UserID");
	}
	Sql.Format("UPDATE Actor SET UsreID = %d WHERE ActorID = %d", m_new_objid, m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("角色转移失败！");
	else
		AfxMessageBox("角色转移成功,起飞！");
}

// 屏蔽客户输入esc键或enter键退出程序
BOOL CMFCAppManagerDlg::PreTranslateMessage(MSG* pMsg)
{
	// TODO: 在此添加专用代码和/或调用基类
	if (pMsg->message == WM_KEYDOWN   &&   pMsg->wParam == VK_RETURN)
		return  TRUE;
	return CDialog::PreTranslateMessage(pMsg);
}


void CMFCAppManagerDlg::OnEnChangeEditnameObjid()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonYesBojid()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	CString Sql;
	Sql.Format("SELECT * FROM Actor WHERE ActorID = %s", m_str_bojid.GetBuffer());

	//OnInitDialog();
	if (!ExcuteCmd(Sql))
		AfxMessageBox("绑定失败！");
	else
		AfxMessageBox("绑定成功！");
	m_point = m_pRecordset->GetCollect("point");
	m_int_hold = m_pRecordset->GetCollect("HoldMoney");
	m_int_exp = m_pRecordset->GetCollect("ExploitAll");
	m_name = m_pRecordset->GetCollect("ActorName");
	m_obj_id = atoi(CT2A(m_str_bojid.GetBuffer()));
	m_int_level = m_pRecordset->GetCollect("ExploitLevel");
	m_int_camp = m_pRecordset->GetCollect("CampID");
	m_int_sex = m_pRecordset->GetCollect("Sex");
	m_binding = true;
}


void CMFCAppManagerDlg::OnBnClickedButtonClan()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (m_clan_name == "")
	{
		AfxMessageBox("请输入正确的兵团名！");
		return;
	}
	CString Sql;
	Sql.Format("UPDATE Clan SET ClanPaySparePerson = 250, ClanPaySpareNum = 250, ClanSparePerson = 250, ClanSpareNum = 250, ClanMoney = 99999999, ClanExp = 99999999, ClanLevel = 25, ClanTech = 20, ClanTech2 = 20, ClanTech3 = 20, Popularity = 99999999 WHERE ClanName = \'%s\'", m_clan_name);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("失败！");
	else
		AfxMessageBox("成功！");
}


void CMFCAppManagerDlg::OnEnChangeEditClanName()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonClanDelete()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (m_clan_name == "")
	{
		AfxMessageBox("请输入正确的兵团名！");
		return;
	}
	CString Sql;
	Sql.Format("DELETE FROM Clan WHERE ClanName = = \'%s\'", m_clan_name);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("失败！");
	else
		AfxMessageBox("成功！");
}


void CMFCAppManagerDlg::OnEnChangeEditpointUsername()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditpointUserword()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonUaarOk()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (m_user_word == "" && m_user_name == "")
	{
		AfxMessageBox("请账号密码！");
		return;
	}
	CString Sql;

	Sql.Format("SELECT *FROM %s..account WHERE UserName = \'%s\'", m_Area.GetBuffer(), m_user_name.GetBuffer());
	ExcuteCmd(Sql);
	if (!m_pRecordset->GetadoEOF())
	{
		AfxMessageBox("有相同账号了,请重新输入账号！");
		return;
	}

	Sql.Format("INSERT INTO %s..account (LoginType, UserName, PassWord, AreaWorld, GameWorld, Ip, SerialNO, BuffHardDisk, BuffBios, BuffCpu, ToCenterDB, UserType, SecPsw, lPPFlag, UserMatrix, PromptFlag, PromptMsg, ConfigVIP, MediaID, QQ, TxzUserName, ActorPsw, NewUser, HasPID, Point) VALUES(0, \'%s\', substring(sys.fn_VarBinToHexStr(hashbytes(\'SHA1\', \'%s\')), 3, 128), NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0, 0, substring(sys.fn_VarBinToHexStr(hashbytes(\'SHA1\', \'%s\')), 3, 128), 0, 0, 0, \'login success!\', 0, 0, \'111111\', \'no\', \'da39a3ee5e6b4b0d3255bfef95601890afd80709\', 0, 1, NULL)", m_Area.GetBuffer(), m_user_name.GetBuffer(), m_user_word.GetBuffer(), m_user_word.GetBuffer());
	if (!ExcuteCmd(Sql))
		AfxMessageBox("失败！");
	else
		AfxMessageBox("成功！");
}


void CMFCAppManagerDlg::OnEnChangeEditpointUsernameSet()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditpointUserwordset()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonUaarOk2()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (m_set_user_name == "" && m_set_user_world == "")
	{
		AfxMessageBox("请账号密码！");
		return;
	}
	CString Sql;
	Sql.Format("SELECT *FROM %s..account WHERE UserName = \'%s\'", m_Area.GetBuffer(), m_set_user_name.GetBuffer());
	if (!ExcuteCmd(Sql))
		AfxMessageBox("获取账号信息失败！");
	else
	{
		if (m_pRecordset->GetadoEOF())
		{
			AfxMessageBox("没有这个账号！");
			return;
		}
	}
	Sql.Format("UPDATE %s..account SET PassWord = substring(sys.fn_VarBinToHexStr(hashbytes(\'SHA1\', \'%s\')), 3, 128) WHERE UserName = \'%s\'", m_Area.GetBuffer(), m_set_user_world.GetBuffer(), m_set_user_name.GetBuffer());
	if (!ExcuteCmd(Sql))
		AfxMessageBox("失败！");
	else
		AfxMessageBox("成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton2Hy()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'7\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format("INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'7\',\'%d\',0x89130000070001003006FFFFFFFFFF0A0C0D3B0DC3381B104700002F1B0C47491F491F4075407540759A659A659A6577081C0C1828BD5900005B0087A6010320202020202020000000000000000000000000000000000000000000000000000000591B0000070101003006FFFFFFFFFF0E100D3B0DC3E11E36480000DD1E2548E707E70780758075807500000000000077081C091408BD5900005B00F6E1010320202020202020000000000000000000000000000000000000000000000000000000591B0000070201003006FFFFFFFFFF0E170D3B0DC3E11E36480000DD1E2548E707E70780758075807500000000000077081C091434BD5900005B00C0E20103202020202020200000000000000000000000000000000000000000000000000000002D1A0000070301003006FFFFFFFFFF0E130D3B0DC35D1EE1470000541EDD4770427042807580758075A98CA98CA98C77081C090512BD5900005B00BDD3010320202020202020000000000000000000000000000000000000000000000000000000B5140000070401003006FFFFFFFFFF0A1D0D3B0DC3B020834A00006520424A491F491FF084F084F084AC61AC61AC6177081C083534BD5900005B00DACA01032020202020202000000000000000000000000000000000000000000000000000000031110000070A01003006FFFFFFFFFF0A190D3B0DC3B210EC4100008110DF41A03AA03A587558755875B561B561B56177081C081F2ABD5900005B0076BC01032020202020202000000000000000000000000000000000000000000000000000000095110000070B01003006FFFFFFFFFF0A0B0D3B0DC3D6129A42000085128D42A03AA03A00850085008591659165916577081C08102BBD5900000100CCB0010320202020202020000000000000000000000000000000000000000000000000000000ED130000070C01003006FFFFFFFFFF0A150D3B0DC34F1C5D470000FE1B544770427042407540754075B08CAF8CAF8C77081C0C1E31BD5900005B0098AB01032020202020202000000000000000000000000000000000000000000000000000000051140000070D01003006FFFFFFFFFF0AFE0C3B0DC318232B4C0000E322274C491F491F687568756875AF61AF61AF6177081C0B0B16BD5900005B00EE7401032020202020202000000000000000000000000000000000000000000000000000000051140000070E01003006FFFFFFFFFF0A020D3B0DC318232B4C0000E222264C491F491F687568756875AF61AF61AF6177081C0B2C02BD5900005B00E58C01032020202020202000000000000000000000000000000000000000000000000000000009200000071801003006FFFFFFFFFF0EFF0C3B0DC33A1FF4480000261FE7487042704280758075807500000000000077081C092E00BD5900005B0066FE01032020202020202000000000000000000000000000000000000000000000000000000009200000071901003006FFFFFFFFFF0E040D3B0DC33A1FF4480000261FE7487042704280758075807500000000000077081C092210BD5900005B00C2F001032020202020202000000000000000000000000000000000000000000000000000000009200000071A01003006FFFFFFFFFF0E020D3B0DC33A1FF4480000261FE7487042704280758075807500000000000077081C09330FBD5900005B00A30401032020202020202000000000000000000000000000000000000000000000000000000009200000071B01003006FFFFFFFFFF0EFE0C3B0DC33A1FF4480000261FE7487042704280758075807500000000000077081C093400BD5900005B007205010320202020202020000000000000000000000000000000000000000000000000000000DD050000072201003006FFFFFFFFFF0ED00C3B0DC30C2AFC4D0000CA29AC4D491F491FE084E084E084A48CA38CA38C77081C0A0810BD5900005B00C617010320202020202020000000000000000000000000000000000000000000000000000000A45C0100072B01000000FFFFFFFFFF0000000000003D5801000000000000000000000000000000000000000000000077081C16361F000000005B00FC0B0107000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'16\')	", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton2Zs()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'7\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format("INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'7\',\'%d\',0xF51A0000070001003006FFFFFFFFFF0E69095D0DC3410AD23D00003B0AC13D24A424A450755075507500000000000077081B083A35C45500005B00F4C20103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000F51A0000070101003006FFFFFFFFFF0E86095D0DC3410AD23D00003B0AC03D24A424A450755075507500000000000077081B083B13C45500005B0033C30103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000B90B0000070201003006FFFFFFFFFF0E48075D0DC320179B450000F2168E45611B611BD884D884D88400000000000077081B091E18C45500005B0085D50103B7B6C4B3C8CB610000000000000000000000000000000000000000000000000000003D0F0000070301003006FFFFFFFFFF0E71075D0DC32919CC460000E118C846A0A0A0A000810081008100000000000077081B091A10C45500005B0005D30103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000C9190000070401003006FFFFFFFFFF0E8C095D0DC3CA097D3D0000C009783D883E883E787578757875A98CA98CA98C77081B083415C45500005B008EBF0103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000A10F0000070A01003006FFFFFFFFFF0A7C095D0DC3B506BB3C0000AB06B63C611B611B3875387538759A659A659A6577081B030028C45500005B00C8E20103B7B6C4B3C8CB6100000000000000000000000000000000000000000000000000000005100000070B01003006FFFFFFFFFF0A97095D0DC3BC07073D00006607FD3C883E883E387538753875B08CAF8CAF8C77081B023313C45500005B0082D90103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000CD100000070C01003006FFFFFFFFFF0AAD095D0DC3010CFC3F0000B10BCB3F611B611BF084F084F084AC61AC61AC6177081B032734C45500005B00A1080103B7B6C4B3C8CB6100000000000000000000000000000000000000000000000000000031110000070D01003006FFFFFFFFFF0A87095D0DC3B210EC4100007E10DF41A03AA03A587558755875B561B561B56177081B032104C45500005B00C7020103B7B6C4B3C8CB6100000000000000000000000000000000000000000000000000000095110000070E01003006FFFFFFFFFF0A97095D0DC3D6129A42000086128D42A03AA03A00850085008591659165916577081B030C2CC45500005B0081EF0103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000A51F0000071801003006FFFFFFFFFF0EE6095D0DC3A60A8F3E0000950A833E883E883E78757875787500000000000077081B090124C45500005B0094C40103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000A51F0000071901003006FFFFFFFFFF0ED20A5D0DC3A60A8F3E0000960A813E883E883E78757875787500000000000077081B090304C45500005B008BC50103B7B6C4B3C8CB61000000000000000000000000000000000000000000000000000000A51F0000071A01003006FFFFFFFFFF0ED50A5D0DC3A60A8F3E0000960A813E883E883E78757875787500000000000077081B090914C45500005B00D4C90103B7B6C4B3C8CB6100000000000000000000000000000000000000000000000000000069100000072201003006FFFFFFFFFF0AA00A5D0DC36F0E8C410000350E8641611B611B687568756875AF61AF61AF6177081B091411C45500005B007ACF0103B7B6C4B3C8CB6100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'14\')	", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnBnClickedButton2Fs()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Sql;
	Sql.Format("delete from dbo.Goods where ContainerID=\'7\' and  ActorID=\'%d\'", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("清空失败！");
	Sql.Format("INSERT INTO dbo.Goods(ContainerID,ActorID,GoodsBuf,GoodsNum) VALUES(\'7\',\'%d\',0xD5170000071801003006FFFFFFFFFF0A0C0D3B0DC3F72C2D500000B12C225058465846487548754875B08CAF8CAF8C77081C012B13BA5900005B00A06B0103CED2BFB4C4E3C3C7CDE600000000000000000000000000000000000000000000000071170000071901003006FFFFFFFFFF0AF40C190DC3D52BE24F0000CA2BDE4F312331234875487548759A659A659A6577081A0E2812C35500005B005ACF0103C6A8C4B3C8CB610000000000000000000000000000000000000000000000000000009D180000071A01003006FFFFFFFFFF0AF20C190DC37331585300002D31105331233123F084F084F084AC61AC61AC6177081B0C2D16C35500005B0040390103C6A8C4B3C8CB6100000000000000000000000000000000000000000000000000000039180000071B01003006FFFFFFFFFF0A0D0D190DC3D83312550000A6330F5531233123687568756875AF61AF61AF6177081B0B2622C35500005B0095140103C6A8C4B3C8CB6100000000000000000000000000000000000000000000000000000039180000071C01003006FFFFFFFFFF0A090D190DC3D83312550000A6330F5531233123687568756875AF61AF61AF6177081B0B1F2FC35500005B00A6100103C6A8C4B3C8CB61000000000000000000000000000000000000000000000000000000411F0000072201003006FFFFFFFFFF0EF00C190DC3952F0D510000922FFC5024A424A448754875487500000000000077081B0D0A0FC35500005B00AF4F0103C6A8C4B3C8CB61000000000000000000000000000000000000000000000000000000411F0000072301003006FFFFFFFFFF0EE00C190DC3952F0D510000922FFC5024A424A448754875487500000000000077081B0D0A1FC35500005B00DF4F0103C6A8C4B3C8CB610000000000000000000000000000000000000000000000000000006D200000072401003006FFFFFFFFFF0E310D3B0DC3E52FC9510000CC2FBD515846584688758875887500000000000077081B0D1D2BC35500005B00BD5F0103C6A8C4B3C8CB610000000000000000000000000000000000000000000000000000006D200000072501003006FFFFFFFFFF0E290D3B0DC3E52FC9510000CC2FBD515846584688758875887500000000000077081B0E0E27C35500006D00CA050103C6A8C4B3C8CB610000000000000000000000000000000000000000000000000000006D200000072601003006FFFFFFFFFF0E320D3B0DC3E52FC9510000CC2FBD515846584688758875887500000000000077081B0D1D37C35500005B00E75F0103C6A8C4B3C8CB610000000000000000000000000000000000000000000000000000006D200000072701003006FFFFFFFFFF0E2B0D3B0DC3E52FC9510000CC2FBD515846584688758875887500000000000077081B0D370AC35500005B0090000103C6A8C4B3C8CB6100000000000000000000000000000000000000000000000000000031110000072801003006FFFFFFFFFF0AFA0C190DC3B210EC4100008210E041A03AA03A587558755875B561B561B56177081B0D0605C35500005B00744B0103C6A8C4B3C8CB6100000000000000000000000000000000000000000000000000000095110000072901003006FFFFFFFFFF0AF40C190DC3D6129A42000090128E42A03AA03A00850085008591659165916577081B0D0201C35500005B00CA460103C6A8C4B3C8CB610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\'13\')	", m_obj_id);
	if (!ExcuteCmd(Sql))
		AfxMessageBox("复制失败！");
	else
		AfxMessageBox("复制成功！");
}


void CMFCAppManagerDlg::OnEnChangeEditIdididi()
{
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditUser()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditCatalog()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnEnChangeEditArea()
{
	UpdateData(TRUE);
	UpdateData(FALSE);
}


void CMFCAppManagerDlg::OnBnClickedButtonMssageGet()
{
	// TODO: 在此添加控件通知处理程序代码
	if (!m_start)
	{
		AfxMessageBox("请先连接数据库！");
		return;
	}
	if (!m_binding)
	{
		AfxMessageBox("请先输入角色名称绑定！");
		return;
	}
	CString Point_S;
	Point_S.Format("%d", m_point);
	CString Level_S;
	Level_S.Format("%d", m_int_level);
	CString Hold_S;
	Hold_S.Format("%d", m_int_hold);
	CString Exp_S;
	Exp_S.Format("%d", m_int_exp);
	CString OBJ_S;
	OBJ_S.Format("%d", m_obj_id);
	CString Camp_S;
	if (m_int_camp == 1)
		Camp_S = "联邦";
	else
		Camp_S = "帝国";
	CString Sex_S;
	if (m_int_sex == 1)
		Sex_S = "男";
	else
		Sex_S = "女";

	Message  Dlg;
	Dlg.UpData(m_name, Level_S, Point_S, Hold_S, Exp_S, Sex_S, Camp_S, OBJ_S);
	Dlg.DoModal();
}


void CMFCAppManagerDlg::OnBnClickedCheckJzmm()
{
	// TODO: 在此添加控件通知处理程序代码
	CButton* pBtn = (CButton*)GetDlgItem(IDC_CHECK_JZMM);
	int state = pBtn->GetCheck();
	//上面的也可以绑定一个变量做处理
	if (state == 1) // 选中
		write_reg_sz();
	else
		delete_value();
}

void CMFCAppManagerDlg::soleIdInit()
{
	char* AddressValue = new char[1024];
	memset(AddressValue, '\0', sizeof(char) * 1024);
	G_GetMacAddress(AddressValue);
	CString macValue(AddressValue);
	delete[] AddressValue;

	CString cpuID;
	cpuID.Format("%u", GetCpuID());


	CString only_value = macValue + '-' + cpuID + '-';
	int temp_count = 0;
	temp_count = only_value.GetLength() + 1;
	char* temp_string = new char[temp_count];
	memset(temp_string, '\0', temp_count);
	memcpy(temp_string, only_value.GetBuffer(), temp_count - 1);
	for (int i = 0; i < temp_count; i++)
	{
		if (temp_string[i] == '-')
		{
			temp_string[i] = rand() % 26 + 'A';
		}
		else
		{
			temp_string[i] = Stestring(temp_string[i]);
		}
	}
	m_sole_id = temp_string;
	delete[] temp_string;
	temp_string = nullptr;
}

void CMFCAppManagerDlg::RememberInit()
{
	if (read_reg_sz())
	{
		((CButton*)GetDlgItem(IDC_CHECK_JZMM))->SetCheck(TRUE);

		AfxOleInit();
		HRESULT hr;
		hr = m_pConnection.CreateInstance("ADODB.Connection");
		m_pConnection->ConnectionTimeout = 8;
		try
		{
			CString temp;
			temp.Format("Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Password=wl1634968804.;Initial Catalog=GameDB;Data Source=49.234.10.172");
			_bstr_t strConnect = temp;//初始化连接  
			hr = m_pConnection->Open(strConnect, "", "", adModeUnknown);//打开数据库
			if (FAILED(hr))
			{
				AfxMessageBox("请检查网络!");
				return;
			}
		}
		catch (_com_error e)
		{
			AfxMessageBox("出错啦 请联系作者!qq960772298!");
			return;
		}
		CString Sql;

		Sql.Format("SELECT * FROM MyOwn WHERE SoleID = \'%s\'", m_sole_id.GetBuffer());
		if (!ExcuteCmd(Sql))
			return;
		if (!m_pRecordset->BOF)
		{
			m_ip_pont = m_pRecordset->GetCollect("Sourceip");
			m_world = m_pRecordset->GetCollect("Password");
			UpdateData(FALSE);
		}


		//关闭并释放记录集
		if (m_pRecordset->State)
			m_pRecordset->Close();
		m_pRecordset.Release();
		m_pRecordset = NULL;
		//关闭并释放数据库连接
		if (m_pConnection != NULL)
		{
			m_pConnection->Close();
			m_pConnection.Release();
			m_pConnection = NULL;
		}
	}
}
